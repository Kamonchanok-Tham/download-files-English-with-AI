<!DOCTYPE html>
<html lang="en">

<head>
    <meta charset="UTF-8">
    <title>Document</title>
    <link rel="stylesheet" href="../style/uploadfiles.css">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
</head>

<body>
    <div class="outCon">
        <div class="container">
            <h2>Upload file (test)</h2>
            <div class="file-row">
                <span id="fileName" class="file-name">
                    ยังไม่ได้เลือกไฟล์
                </span>

                <label class="file-btn">
                    Select file
                    <input type="file" id="file" hidden accept=".pdf,.jpg,.jpeg,.png" onchange="showFileName()">
                </label>
            </div>
            <br />
            <button onclick=" upload()">Upload</button>
        </div>
        <div id="result"></div>
    </div>



    <script>
        function showFileName() {
            const fileInput = document.getElementById("file");
            const fileName = document.getElementById("fileName");

            if (fileInput.files.length > 0) {
                fileName.textContent = fileInput.files[0].name;
            } else {
                fileName.textContent = "ยังไม่ได้เลือกไฟล์";
            }
        }
        async function upload() {
            const fileInput = document.getElementById("file");
            if (!fileInput.files.length) {
                alert("select your file");
                return;
            }

            const formData = new FormData();
            formData.append("file", fileInput.files[0]);

            const res = await fetch("https://tiny-darkness-94e3.kamonchanok-10292.workers.dev/", {
                method: "POST",
                body: formData,
            });

            const data = await res.json();

            if (data.success) {
                document.getElementById("result").innerHTML = `
                <p>upload success</p>
                <a href="${data.url}" target="_blank">view</a>
                `;
            }

        }
    </script>

</body>

</html>